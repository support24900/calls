<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mirai Skin ‚Äî AI Cart Recovery Agent</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #0a0a0a;
      color: #e8e8e8;
      min-height: 100vh;
      overflow-x: hidden;
    }

    .gradient-bg {
      position: fixed;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle at 30% 20%, rgba(139, 92, 246, 0.08) 0%, transparent 50%),
                  radial-gradient(circle at 70% 80%, rgba(236, 72, 153, 0.06) 0%, transparent 50%),
                  radial-gradient(circle at 50% 50%, rgba(59, 130, 246, 0.04) 0%, transparent 50%);
      z-index: 0;
      animation: drift 20s ease-in-out infinite;
    }

    @keyframes drift {
      0%, 100% { transform: translate(0, 0) rotate(0deg); }
      33% { transform: translate(2%, -2%) rotate(1deg); }
      66% { transform: translate(-1%, 1%) rotate(-0.5deg); }
    }

    .container {
      position: relative;
      z-index: 1;
      max-width: 1000px;
      margin: 0 auto;
      padding: 60px 24px;
    }

    .header {
      text-align: center;
      margin-bottom: 64px;
    }

    .logo {
      display: inline-flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 24px;
    }

    .logo-icon {
      width: 48px;
      height: 48px;
      background: linear-gradient(135deg, #8b5cf6, #ec4899);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
    }

    .logo-text {
      font-size: 20px;
      font-weight: 600;
      letter-spacing: -0.02em;
      color: #fff;
    }

    h1 {
      font-size: 48px;
      font-weight: 700;
      letter-spacing: -0.03em;
      line-height: 1.1;
      margin-bottom: 16px;
      background: linear-gradient(135deg, #fff 0%, #a78bfa 50%, #ec4899 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .subtitle {
      font-size: 18px;
      color: #888;
      max-width: 560px;
      margin: 0 auto;
      line-height: 1.6;
    }

    .status-bar {
      display: flex;
      justify-content: center;
      gap: 32px;
      margin-top: 32px;
      flex-wrap: wrap;
    }

    .status-item {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 14px;
      color: #888;
    }

    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      animation: pulse 2s ease-in-out infinite;
    }

    .status-dot.green { background: #22c55e; box-shadow: 0 0 8px rgba(34, 197, 94, 0.4); }
    .status-dot.yellow { background: #eab308; box-shadow: 0 0 8px rgba(234, 179, 8, 0.4); }
    .status-dot.red { background: #ef4444; box-shadow: 0 0 8px rgba(239, 68, 68, 0.4); }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    .flow-section {
      margin-bottom: 64px;
    }

    .section-title {
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: #666;
      margin-bottom: 24px;
      text-align: center;
    }

    .flow {
      display: flex;
      align-items: stretch;
      gap: 0;
      justify-content: center;
      flex-wrap: wrap;
    }

    .flow-step {
      flex: 1;
      min-width: 180px;
      max-width: 220px;
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 255, 255, 0.06);
      border-radius: 16px;
      padding: 24px 20px;
      text-align: center;
      position: relative;
      transition: all 0.3s ease;
    }

    .flow-step:hover {
      background: rgba(255, 255, 255, 0.06);
      border-color: rgba(139, 92, 246, 0.3);
      transform: translateY(-2px);
    }

    .flow-arrow {
      display: flex;
      align-items: center;
      color: #333;
      font-size: 20px;
      padding: 0 4px;
    }

    .step-icon {
      font-size: 32px;
      margin-bottom: 12px;
    }

    .step-label {
      font-size: 13px;
      font-weight: 600;
      color: #ccc;
      margin-bottom: 6px;
    }

    .step-desc {
      font-size: 12px;
      color: #666;
      line-height: 1.5;
    }

    .features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 16px;
      margin-bottom: 64px;
    }

    .feature-card {
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid rgba(255, 255, 255, 0.06);
      border-radius: 16px;
      padding: 28px 24px;
      transition: all 0.3s ease;
    }

    .feature-card:hover {
      background: rgba(255, 255, 255, 0.04);
      border-color: rgba(139, 92, 246, 0.2);
    }

    .feature-icon {
      font-size: 28px;
      margin-bottom: 14px;
    }

    .feature-title {
      font-size: 16px;
      font-weight: 600;
      color: #ddd;
      margin-bottom: 8px;
    }

    .feature-desc {
      font-size: 13px;
      color: #777;
      line-height: 1.6;
    }

    .agent-card {
      background: linear-gradient(135deg, rgba(139, 92, 246, 0.08), rgba(236, 72, 153, 0.05));
      border: 1px solid rgba(139, 92, 246, 0.15);
      border-radius: 20px;
      padding: 40px;
      margin-bottom: 64px;
    }

    .agent-header {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 24px;
    }

    .agent-avatar {
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: linear-gradient(135deg, #8b5cf6, #ec4899);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
    }

    .agent-name {
      font-size: 22px;
      font-weight: 600;
      color: #fff;
    }

    .agent-role {
      font-size: 14px;
      color: #a78bfa;
    }

    .chat-bubbles {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .bubble {
      max-width: 80%;
      padding: 14px 18px;
      border-radius: 16px;
      font-size: 14px;
      line-height: 1.5;
    }

    .bubble.agent {
      background: rgba(139, 92, 246, 0.12);
      border: 1px solid rgba(139, 92, 246, 0.2);
      color: #d4bfff;
      align-self: flex-start;
      border-bottom-left-radius: 4px;
    }

    .bubble.customer {
      background: rgba(255, 255, 255, 0.06);
      border: 1px solid rgba(255, 255, 255, 0.1);
      color: #aaa;
      align-self: flex-end;
      border-bottom-right-radius: 4px;
    }

    .endpoints {
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid rgba(255, 255, 255, 0.06);
      border-radius: 16px;
      overflow: hidden;
    }

    .endpoint {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 16px 24px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.04);
      font-family: 'SF Mono', 'Fira Code', monospace;
      font-size: 13px;
    }

    .endpoint:last-child { border-bottom: none; }

    .method {
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 11px;
      font-weight: 700;
      min-width: 52px;
      text-align: center;
    }

    .method.get { background: rgba(34, 197, 94, 0.15); color: #4ade80; }
    .method.post { background: rgba(59, 130, 246, 0.15); color: #60a5fa; }

    .endpoint-path { color: #ccc; }
    .endpoint-desc { color: #555; margin-left: auto; font-family: -apple-system, sans-serif; }

    .footer {
      text-align: center;
      padding-top: 40px;
      border-top: 1px solid rgba(255, 255, 255, 0.04);
      color: #444;
      font-size: 13px;
    }

    .tech-stack {
      display: flex;
      justify-content: center;
      gap: 24px;
      margin-top: 16px;
      flex-wrap: wrap;
    }

    .tech {
      font-size: 12px;
      color: #555;
      padding: 6px 14px;
      border: 1px solid rgba(255, 255, 255, 0.06);
      border-radius: 20px;
    }

    @media (max-width: 640px) {
      h1 { font-size: 32px; }
      .flow { flex-direction: column; align-items: center; }
      .flow-arrow { transform: rotate(90deg); }
      .container { padding: 40px 16px; }
    }
  </style>
</head>
<body>
  <div class="gradient-bg"></div>
  <div class="container">

    <div class="header">
      <div class="logo">
        <div class="logo-icon">M</div>
        <span class="logo-text">Mirai Skin</span>
      </div>
      <h1>AI Cart Recovery Agent</h1>
      <p class="subtitle">When customers abandon checkout, Mia calls them back ‚Äî a friendly AI skincare advisor who answers questions, offers discounts, and closes the sale.</p>
      <div class="status-bar" id="statusBar">
        <div class="status-item">
          <div class="status-dot" id="serverDot"></div>
          <span id="serverStatus">Checking server...</span>
        </div>
        <div class="status-item">
          <div class="status-dot" id="dbDot"></div>
          <span id="dbStatus">Checking database...</span>
        </div>
      </div>
    </div>

    <div class="flow-section">
      <div class="section-title">How It Works</div>
      <div class="flow">
        <div class="flow-step">
          <div class="step-icon">üõí</div>
          <div class="step-label">Cart Abandoned</div>
          <div class="step-desc">Customer leaves items in cart on mirai-skin.com</div>
        </div>
        <div class="flow-arrow">‚Üí</div>
        <div class="flow-step">
          <div class="step-icon">‚è±Ô∏è</div>
          <div class="step-label">Klaviyo Detects</div>
          <div class="step-desc">Waits 15 min, checks if order was placed</div>
        </div>
        <div class="flow-arrow">‚Üí</div>
        <div class="flow-step">
          <div class="step-icon">üìû</div>
          <div class="step-label">Mia Calls</div>
          <div class="step-desc">AI agent calls with product knowledge & discounts</div>
        </div>
        <div class="flow-arrow">‚Üí</div>
        <div class="flow-step">
          <div class="step-icon">üí∞</div>
          <div class="step-label">Sale Recovered</div>
          <div class="step-desc">Sends checkout link via SMS, tracks conversion</div>
        </div>
      </div>
    </div>

    <div class="agent-card">
      <div class="agent-header">
        <div class="agent-avatar">üß¥</div>
        <div>
          <div class="agent-name">Mia</div>
          <div class="agent-role">AI Skincare Advisor ‚Äî Mirai Skin</div>
        </div>
      </div>
      <div class="chat-bubbles">
        <div class="bubble agent">Hi Sarah! This is Mia from Mirai Skin. I noticed you were checking out the Snail Mucin Essence and Centella Cream ‚Äî amazing picks! Any questions I can help with?</div>
        <div class="bubble customer">Yeah actually, is the snail mucin good for dry skin?</div>
        <div class="bubble agent">Absolutely! Snail mucin is incredible for dry skin ‚Äî it's packed with hyaluronic acid and glycoproteins that deeply hydrate and repair your skin barrier. It layers beautifully under the Centella Cream too. Want me to send you the checkout link? I can even get you 10% off!</div>
        <div class="bubble customer">Ooh yes please, send me the link!</div>
        <div class="bubble agent">Done! I just texted you the link with your 10% discount code MIRAI-SK2026. Just click it and you're all set. Happy glowing! ‚ú®</div>
      </div>
    </div>

    <div class="section-title">Capabilities</div>
    <div class="features">
      <div class="feature-card">
        <div class="feature-icon">üß†</div>
        <div class="feature-title">Korean Skincare Expert</div>
        <div class="feature-desc">Knows ingredients, routines, skin types. Answers product questions like a real beauty advisor.</div>
      </div>
      <div class="feature-card">
        <div class="feature-icon">üí∏</div>
        <div class="feature-title">Dynamic Discounts</div>
        <div class="feature-desc">Creates unique one-time Shopify discount codes on the fly to overcome price hesitation.</div>
      </div>
      <div class="feature-card">
        <div class="feature-icon">üì±</div>
        <div class="feature-title">SMS Checkout Links</div>
        <div class="feature-desc">Sends recovery link via text during the call so customers can buy instantly.</div>
      </div>
      <div class="feature-card">
        <div class="feature-icon">üîÅ</div>
        <div class="feature-title">Smart Dedup</div>
        <div class="feature-desc">Never calls the same customer twice in 24 hours. Respects "don't call me" requests.</div>
      </div>
      <div class="feature-card">
        <div class="feature-icon">üìä</div>
        <div class="feature-title">Outcome Tracking</div>
        <div class="feature-desc">Logs every call ‚Äî outcome, transcript, duration. Syncs back to Klaviyo for segmentation.</div>
      </div>
      <div class="feature-card">
        <div class="feature-icon">‚ö°</div>
        <div class="feature-title">15-Min Response</div>
        <div class="feature-desc">Strikes while the iron is hot ‚Äî calls within 15 minutes of cart abandonment.</div>
      </div>
    </div>

    <div class="section-title">API Endpoints</div>
    <div class="endpoints">
      <div class="endpoint">
        <span class="method get">GET</span>
        <span class="endpoint-path">/health</span>
        <span class="endpoint-desc">Health check</span>
      </div>
      <div class="endpoint">
        <span class="method post">POST</span>
        <span class="endpoint-path">/api/webhook/abandoned-cart</span>
        <span class="endpoint-desc">Klaviyo trigger</span>
      </div>
      <div class="endpoint">
        <span class="method post">POST</span>
        <span class="endpoint-path">/api/webhook/call-status</span>
        <span class="endpoint-desc">Vapi call reports</span>
      </div>
      <div class="endpoint">
        <span class="method post">POST</span>
        <span class="endpoint-path">/api/webhook/send-sms</span>
        <span class="endpoint-desc">Send checkout link</span>
      </div>
      <div class="endpoint">
        <span class="method post">POST</span>
        <span class="endpoint-path">/api/webhook/apply-discount</span>
        <span class="endpoint-desc">Create discount + SMS</span>
      </div>
    </div>

    <div class="footer">
      <p>Mirai Skin AI Cart Recovery Agent</p>
      <div class="tech-stack">
        <span class="tech">Shopify</span>
        <span class="tech">Klaviyo</span>
        <span class="tech">Vapi AI</span>
        <span class="tech">Twilio</span>
        <span class="tech">Turso</span>
        <span class="tech">Express</span>
      </div>
    </div>
  </div>

  <script>
    async function checkStatus() {
      const serverDot = document.getElementById('serverDot');
      const serverStatus = document.getElementById('serverStatus');
      const dbDot = document.getElementById('dbDot');
      const dbStatus = document.getElementById('dbStatus');

      try {
        const res = await fetch('/health');
        const data = await res.json();
        serverDot.className = 'status-dot green';
        serverStatus.textContent = 'Server online';
      } catch {
        serverDot.className = 'status-dot red';
        serverStatus.textContent = 'Server offline';
      }

      try {
        const res = await fetch('/api/webhook/call-status', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ message: { type: 'ping' } })
        });
        if (res.status === 503) {
          dbDot.className = 'status-dot yellow';
          dbStatus.textContent = 'Database not configured';
        } else {
          dbDot.className = 'status-dot green';
          dbStatus.textContent = 'Database connected';
        }
      } catch {
        dbDot.className = 'status-dot red';
        dbStatus.textContent = 'Database error';
      }
    }

    checkStatus();
  </script>
</body>
</html>
