<% var title = 'Stats'; %>
<%- include('layout-head') %>

<h1 class="text-2xl font-bold text-gray-800 mb-6">Dashboard Stats</h1>

<div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
  <div class="bg-white rounded-xl shadow-sm p-6">
    <div class="text-sm text-gray-500 mb-1">Total Calls Made</div>
    <div class="text-3xl font-bold text-gray-800"><%= callStats.totalCalls %></div>
  </div>
  <div class="bg-white rounded-xl shadow-sm p-6">
    <div class="text-sm text-gray-500 mb-1">Carts Called</div>
    <div class="text-3xl font-bold text-blue-600"><%= stats.callsMade %></div>
  </div>
  <div class="bg-white rounded-xl shadow-sm p-6">
    <div class="text-sm text-gray-500 mb-1">Conversions</div>
    <div class="text-3xl font-bold text-green-600"><%= stats.conversions %></div>
  </div>
</div>

<div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
  <div class="bg-white rounded-xl shadow-sm p-6">
    <div class="text-sm text-gray-500 mb-1">Recovery Rate</div>
    <div class="text-3xl font-bold text-pink-600"><%= callStats.completedCalls > 0 ? ((callStats.recoveredCalls / callStats.completedCalls) * 100).toFixed(1) : '0.0' %>%</div>
  </div>
  <div class="bg-white rounded-xl shadow-sm p-6">
    <div class="text-sm text-gray-500 mb-1">Revenue Recovered</div>
    <div class="text-3xl font-bold text-pink-600">$<%= Number(callStats.revenueRecovered || 0).toFixed(2) %></div>
  </div>
</div>

<div class="bg-white rounded-xl shadow-sm p-6">
  <h2 class="text-lg font-semibold text-gray-700 mb-4">Abandoned Carts Per Day (Last 30 Days)</h2>
  <% if (stats.cartsPerDay.length > 0) { %>
    <div class="space-y-2">
      <% stats.cartsPerDay.forEach(function(day) { %>
        <div class="flex items-center gap-4">
          <div class="w-24 text-sm text-gray-500 shrink-0"><%= day.day %></div>
          <div class="flex-1 bg-gray-100 rounded-full h-6 overflow-hidden">
            <div class="bg-pink-400 h-full rounded-full flex items-center pl-2" style="width: <%= Math.max(day.carts * 10, 5) %>%">
              <span class="text-xs text-white font-bold"><%= day.carts %></span>
            </div>
          </div>
          <div class="w-24 text-right text-sm font-semibold text-gray-600">$<%= Number(day.value || 0).toFixed(0) %></div>
        </div>
      <% }); %>
    </div>
  <% } else { %>
    <p class="text-gray-400 text-center py-8">No data yet</p>
  <% } %>
</div>

<%- include('layout-foot') %>
